#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸ”’ Running pre-commit checks..."

# Check for any console.log or debug statements
if grep -r "console.log" entry/src/main/ets --include="*.ets" 2>/dev/null; then
    echo "âŒ Found console.log statements. Please remove them before committing."
    exit 1
fi

# Check for TODO/FIXME markers
echo "ğŸ“‹ Checking TODO/FIXME markers..."
TODO_COUNT=$(grep -r "TODO\|FIXME" entry/src/main/ets --include="*.ets" | wc -l)
if [ "$TODO_COUNT" -gt 0 ]; then
    echo "âš ï¸  Found $TODO_COUNT TODO/FIXME markers in code"
fi

# Run code linting (if hvigorw is available)
if command -v hvigorw &> /dev/null; then
    echo "ğŸ” Running code linter..."
    hvigorw code-lint
    if [ $? -ne 0 ]; then
        echo "âŒ Code linting failed. Please fix the issues."
        exit 1
    fi
fi

echo "âœ… Pre-commit checks passed!"
